---
apiVersion: v1
kind: ConfigMap
metadata:
  name: frigate-config
  namespace: home-automation
data:
  config.yml: |
    auth:
      enabled: true

    proxy:
      header_map: {}

    mqtt:
      enabled: false

    detectors:
      cpu:
        type: cpu
        num_threads: 4

    database:
      path: /config/frigate.db

    snapshots:
      enabled: true
      retain:
        default: 14

    record:
      enabled: true
      retain:
        days: 7
        mode: motion

    objects:
      track:
        - person
        - cat
        - dog
        - bird
      filters:
        person:
          min_area: 5000
          threshold: 0.7
        cat:
          min_area: 2000
          threshold: 0.6
        dog:
          min_area: 3000
          threshold: 0.6
        bird:
          min_area: 500
          threshold: 0.5

    cameras:
      garden:
        enabled: true
        ffmpeg:
          inputs:
            # High-quality recording stream (main stream)
            - path: rtsp://admin:{FRIGATE_RTSP_PASSWORD}@10.0.0.50:554/cam/realmonitor?channel=1&subtype=0
              roles:
                - record
            # Low-quality detection stream (sub stream)
            - path: rtsp://admin:{FRIGATE_RTSP_PASSWORD}@10.0.0.50:554/cam/realmonitor?channel=1&subtype=1
              roles:
                - detect
        detect:
          enabled: true
          width: 704
          height: 576
          fps: 5
        snapshots:
          enabled: true
          retain:
            default: 14
        record:
          enabled: true
          retain:
            days: 7
            mode: motion
        objects:
          track:
            - person
            - cat
            - dog
            - bird
